<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <th:block th:include="include :: header('收藏夹-公共池列表')" />
</head>
<style>
    #bootstrap-table>thead>tr {background-color: #f94a35;color: white;}
</style>
<body class="gray-bg">

<div class="container-div">
    <div class="row">
        <div class="col-sm-12 search-collapse">
            <form id="formId" class="form-inline">
                <div class="row">
                    <div class="input-group col-xs-2 col-xs-offset-1" style="margin-left: 5px">
                        <div class="input-group-addon " style="background-color: #efefef;width: 120px">星级</div>
                        <select name="customerStar" th:with="type=${@dict.getType('customer_star')}" class="form-control">
                            <option value="">-不限-</option>
                            <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"></option>
                        </select>
                    </div>
                    <div class="input-group col-xs-2 col-xs-offset-1">
                        <div class="input-group-addon " style="background-color: #efefef;width: 120px">客户类型</div>
                        <select name="customerType" th:with="type=${@dict.getType('customer_type')}" class="form-control">
                            <option value="">-不限-</option>
                            <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"></option>
                        </select>
                    </div>

                    <div class="input-group col-xs-2 col-xs-offset-1">
                        <div class="input-group-addon " style="background-color: #efefef;width: 120px">客户状态</div>
                        <select name="customerStatus" th:with="type=${@dict.getType('customer_status')}" class="form-control">
                            <option value="">-不限-</option>
                            <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"></option>
                        </select>
                    </div>
                    <div class="input-group col-xs-2 col-xs-offset-1">
                        <div class="input-group-addon " style="background-color: #efefef;width: 120px">未跟进天数</div>
                        <select name="params[noDays]" th:with="type=${@dict.getType('customer_no_days')}" class="form-control">
                            <option value="">-不限-</option>
                            <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"></option>
                        </select>
                    </div>
                </div><br>
                <div class="row">
                    <div class="input-group col-xs-2" style="margin-left: 5px">
                        <div class="input-group-addon" style="background-color: #efefef;width: 120px">姓名</div>
                        <input type="text" class="form-control" name="customerName">
                    </div>
                    <div class="input-group col-xs-2 col-xs-offset-1">
                        <div class="input-group-addon" style="background-color: #efefef;width: 120px">手机号</div>
                        <input type="text" class="form-control" name="customerPhone">
                        <!--                            </div>-->
                    </div>
                    <div class="input-group col-xs-2 col-xs-offset-1">
                        <div class="input-group-addon" style="background-color: #efefef;width: 120px">最后备注开始</div>
                        <input type="text" class="time-input form-control" id="startTime" name="params[beginRemarkTime]" />
                    </div>
                    <div class="input-group col-xs-2 col-xs-offset-1">
                        <div class="input-group-addon" style="background-color: #efefef;width: 120px">最后备注结束</div>
                        <input type="text" class="time-input form-control" id="endTime" name="params[endRemarkTime]"/>
                    </div>
                </div><br>
                <div class="row">
                    <div class="checkbox check-box" style="margin-left: 5px">
                        <input type="checkbox" name="hasCar" value="1"> <i></i>房
                    </div>
                    <div class="checkbox check-box">
                        <input type="checkbox" name="hasHouse" value="1"> <i></i>车
                    </div>
                    <div class="checkbox check-box">
                        <input type="checkbox" name="hasWarranty" value="1"> <i></i>保单
                    </div>
                    <div class="checkbox check-box">
                        <input type="checkbox" name="hasSocial" value="1"> <i></i>社保
                    </div>
                    <div class="checkbox check-box">
                        <input type="checkbox" name="hasWeilidai" value="1"> <i></i>微粒贷
                    </div>
                    <div class="checkbox check-box">
                        <input type="checkbox" name="hasAccumulation" value="1"> <i></i>公积金
                    </div>
                    <div class="checkbox check-box">
                        <input type="checkbox" name="customerSalary" value="1"> <i></i>代发工资
                    </div>
                    <a class="btn btn-primary btn-rounded btn-sm" onclick="$.table.search()"><i class="fa fa-search"></i>&nbsp;搜索</a>
                </div>
                <input type="text" value="1" hidden name="params[cpType]"></input>
            </form>
        </div>
        <div class="btn-group-sm" id="toolbar" role="group">
            <a class="btn btn-danger multiple disabled" onclick="$.operate.removeAll()" shiro:hasPermission="customer:pool:remove">
                <i class="fa fa-remove"></i> 删除
            </a>
        </div>
        <div class="col-sm-12 select-table table-striped">
            <table id="bootstrap-table"></table>
        </div>
    </div>
</div>
<th:block th:include="include :: footer" />
<script th:inline="javascript">
    var editFlag = [[${@permission.hasPermi('customer:main:edit')}]];
    var removeFlag = [[${@permission.hasPermi('customer:pool:remove')}]];
    var customerSexDatas = [[${@dict.getType('sys_user_sex')}]];
    var customerStatusDatas = [[${@dict.getType('customer_status')}]];
    var customerStarDatas = [[${@dict.getType('customer_star')}]];
    var prefix = ctx + "customer/pool";

    $(function() {
        var options = {
            url: prefix + "/collectList",
            updateUrl: ctx + "customer/main/edit/{id}",
            removeUrl: prefix + "/remove",
            striped: true,//隔行换色
            sortName: "remarkTime",
            sortOrder: "desc",
            showToggle: false,
            modalName: "客户详情",
            uniqueId: "cpId",
            onClickCell: function (field,value,row,$element) {  //点击姓名进入编辑页面
                if (field == 'customerName' && editFlag != "hidden") {
                    $.operate.editTab(row.customerId);
                }
            },
            columns: [{
                checkbox: true
            },
                {
                    field : 'customerId',
                    title : '客户编号',
                    halign: 'center',
                    align: 'center',
                    width: 80
                },
                {
                    field : 'customerName',
                    title : '客户姓名',
                    halign: 'center',
                    align: 'center',
                    width: 80,
                    formatter: function(value, row, index) {
                        return "<span style='color: #b60000;'>"+value+"</span>";
                    }
                },
                {
                    field : 'customerSex',
                    title : '性别',
                    halign: 'center',
                    align: 'center',
                    width: 80,
                    formatter: function(value, row, index) {
                        return $.table.selectDictLabel(customerSexDatas, value);
                    }
                },
                {
                    field : 'customerBirth',
                    title : '年龄',
                    halign: 'center',
                    align: 'center',
                    width: 80,
                    formatter: function(value, row, index) {
                        var date = new Date();
                        return date.getFullYear()-value;
                    }
                },
                {
                    field : 'customerQuota',
                    title : '额度(万)',
                    halign: 'center',
                    align: 'center',
                    width: 80,
                },
                {
                    field : 'customerStar',
                    title : '星级',
                    halign: 'center',
                    align: 'center',
                    width: 80,
                    formatter: function(value, row, index) {
                        return $.table.selectDictLabel(customerStarDatas, value);
                    }
                },
                {
                    field : 'customerStatus',
                    title : '客户状态',
                    halign: 'center',
                    align: 'center',
                    width: 140,
                    formatter: function(value, row, index) {
                        return $.table.selectDictLabel(customerStatusDatas, value);
                    }
                },
                {
                    field : 'userName',
                    title : '归属顾问',
                    halign: 'center',
                    align: 'center',
                    width: 80,
                },
                {
                    field : 'remark',
                    title : '备注',
                    halign: 'center',
                    align: 'left'
                },
                {
                    field : 'distributeTime',
                    title : '分配时间',
                    halign: 'center',
                    align: 'center',
                    width: 140,
                    sortable: true
                },
                {
                    field : 'remarkTime',
                    title : '备注时间',
                    halign: 'center',
                    align: 'center',
                    width: 140,
                    sortable: true
                },
                {
                    field : 'applyTime',
                    title : '申请时间',
                    halign: 'center',
                    align: 'center',
                    width: 140,
                    sortable: true
                }]
        };
        $.table.init(options);
    });
</script>
</body>
</html>